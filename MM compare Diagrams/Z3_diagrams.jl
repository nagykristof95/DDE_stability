using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

valrefZ3=0.5026384325865356 + 0.7478515394410706*im

Z3_RK4_dense=[12.0 12.0 100.0 16.183041460000002 0.003303103340191701 14352.0; 12.0 12.0 200.0 34.72273744 0.0009807018185270975 28752.0; 12.0 12.0 300.0 53.0664956198 0.0007786640382831131 43152.0; 12.0 12.0 400.0 70.0960466798 0.00018512500201359623 57600.0; 12.0 12.0 500.0 90.8980112 0.0007608319413166044 71952.0; 12.0 12.0 600.0 111.7326822198 0.0003694829261426717 86400.0; 12.0 12.0 700.0 128.3099826802 0.0011006253891732186 100800.0; 12.0 12.0 800.0 140.38300419979998 0.0004242682620256177 115200.0; 12.0 12.0 900.0 159.5737206398 0.0008251416580498691 129552.0; 12.0 12.0 1000.0 180.97137718 0.00019060026334682544 144048.0; 12.0 12.0 1100.0 191.8918273598 0.00042831692437539923 158400.0; 12.0 12.0 1200.0 213.88845331980002 0.00013675502649255952 172800.0; 12.0 12.0 1300.0 234.3022899 0.00015413963799573672 187296.0; 12.0 12.0 1400.0 248.65995106 7.63732316098496e-5 201600.0; 12.0 12.0 1500.0 272.2357424402 0.00011572713500052165 216000.0]

Z3_RK4_dense_ad=[12.0 12.0 0.01 4.28041036 0.017097212515017727 3610.8; 12.0 12.0 0.001 7.8814336798 0.0007778423707077997 6675.6; 12.0 12.0 0.0001 11.644184579800001 0.00015087931647972378 9902.4; 12.0 12.0 1.0e-5 18.6155346596 2.6307426756253966e-5 13942.8; 12.0 12.0 1.0e-6 25.67399726 6.101568357124402e-6 18799.2; 12.0 12.0 1.0e-7 35.1884482004 1.0562260970611148e-6 24595.2; 12.0 12.0 1.0e-8 41.817826579999995 1.5284483128027601e-7 33382.8; 12.0 12.0 1.0e-9 62.463894959200005 2.1855520482833754e-8 46455.6; 12.0 12.0 1.0e-10 83.7857124402 2.7658671298938743e-9 66057.6]

Z3_RK4_G_5=[100.0 1.0e-5 0.01 5.170571167333333 11.394068499060012 4136.0; 100.0 1.0e-5 0.001 8.813961366333332 6.926128760142544 7270.0; 100.0 1.0e-5 0.0001 13.572380500666668 2.6821288962247056 11016.0; 100.0 1.0e-5 1.0e-5 17.851571533333335 1.6085076130934477 14422.0; 100.0 1.0e-5 1.0e-6 21.030364834 3.21045323662244 19890.0; 100.0 1.0e-5 1.0e-7 29.061922834 2.0352040896980927 26154.0; 100.0 1.0e-5 1.0e-8 45.79439776766666 3.5201537980650635 36530.0; 100.0 1.0e-5 1.0e-9 58.1462567 16.267254879382634 50754.0; 100.0 1.0e-5 1.0e-10 90.077481534 2.2059192898725093 71242.0]

Z3_RK4_G_10=[100.0 1.0e-10 0.01 6.0706801996666675 2.4742442769628847 4402.0; 100.0 1.0e-10 0.001 9.657884366666666 5.222464607217412 7312.0; 100.0 1.0e-10 0.0001 13.914966534000001 10.908414041932506 10274.0; 100.0 1.0e-10 1.0e-5 17.20321746666667 2.2226138272523592e-5 14172.0; 100.0 1.0e-10 1.0e-6 23.779657133 5.156377310820384e-6 18906.0; 100.0 1.0e-10 1.0e-7 28.030580499333336 1.07828052646813e-6 24828.0; 100.0 1.0e-10 1.0e-8 45.375354333 2.02349669579185e-7 34050.0; 100.0 1.0e-10 1.0e-9 56.412441700333325 2.424291218664565e-8 47134.0; 100.0 1.0e-10 1.0e-10 80.83200893333333 3.281786422567016e-9 66980.0]

Z3_RK4_C=[100.0 1.0e-10 0.01 5.857698279999999 4.339931703081236 4176.2; 100.0 1.0e-10 0.001 10.3900217006 4.368341488091222 6818.6; 100.0 1.0e-10 0.0001 15.832359820200002 2.1071604164266478 11187.8; 100.0 1.0e-10 1.0e-5 22.364760360200002 0.00017331779409365217 15483.8; 100.0 1.0e-10 1.0e-6 33.71757228 2.348582128108337e-5 22471.4; 100.0 1.0e-10 1.0e-7 41.529406480199995 3.5696961357286698e-6 30101.0; 100.0 1.0e-10 1.0e-8 57.94331204059999 4.4539948771022627e-7 41073.8; 100.0 1.0e-10 1.0e-9 81.1024224998 5.7397902841931073e-8 57680.6; 100.0 1.0e-10 1.0e-10 116.5538995798 7.111366130964869e-9 79959.8]

Z3_RK4_C_norm=[100.0 1.0e-5 0.01 12.7064732495 6.484915376113415 6705.0; 100.0 1.0e-5 0.001 19.503980249999998 0.00034560936445385103 9984.0; 100.0 1.0e-5 0.0001 26.8846356 4.3704807633949024e-5 14016.0; 100.0 1.0e-5 1.0e-5 35.533506801 1.1201919157814246e-5 18666.0; 100.0 1.0e-5 1.0e-6 49.04511155 1.6012324545633502e-6 25656.0; 100.0 1.0e-5 1.0e-7 61.6900893 2.383417097716098e-7 38586.0]

Plots.plot(Z3_RK4_dense[:,6],Z3_RK4_dense[:,5],xscale=:log10,yscale=:log10,label="RK4 naive",markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")
Plots.plot!(hcat(Z3_RK4_dense_ad[:,6],Z3_RK4_G_5[:,6],Z3_RK4_G_10[:,6]),hcat(Z3_RK4_dense_ad[:,5],Z3_RK4_G_5[:,5],Z3_RK4_G_10[:,5]),xscale=:log10,yscale=:log10,label=["RK4 ad" "RK4 G int5" "RK4 G int10" "RK4 C"],markershapes= [:circle])
Plots.plot!(Z3_RK4_C_norm[:,6],Z3_RK4_C_norm[:,5],xscale=:log10,yscale=:log10,label="RK4 C norm",markershapes= [:circle])

Plots.plot(Z3_RK4_dense[:,4],Z3_RK4_dense[:,5],xscale=:log10,yscale=:log10,label="RK4 naive",markershapes= [:circle],xlabel = "CPU time",ylabel = "eigenvalue error")
Plots.plot!(hcat(Z3_RK4_dense_ad[:,4],Z3_RK4_G_5[:,4],Z3_RK4_G_10[:,4]),hcat(Z3_RK4_dense_ad[:,5],Z3_RK4_G_5[:,5],Z3_RK4_G_10[:,5]),xscale=:log10,yscale=:log10,label=["RK4 ad" "RK4 G int5" "RK4 G int10" "RK4 C"],markershapes= [:circle])
Plots.plot!(Z3_RK4_C_norm[:,4],Z3_RK4_C_norm[:,5],xscale=:log10,yscale=:log10,label="RK4 C norm",markershapes= [:circle])

Plots.savefig("1.pdf")
