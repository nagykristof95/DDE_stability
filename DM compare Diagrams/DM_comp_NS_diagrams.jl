using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

valref=-0.6896644288103551 + 0.8555322147675607*im

RK4_fix_N=[12.0 12.0 100.0 0.4806944207999998 0.004625350704338379 4764.0; 12.0 12.0 200.0 0.7145421398 0.002305704555864033 9564.0; 12.0 12.0 300.0 1.0805994603999998 0.0015351033624671632 14364.0; 12.0 12.0 400.0 1.3028206403999998 0.0011505270777414566 19212.0; 12.0 12.0 500.0 1.6285163402000002 0.0009200307404749772 23964.0; 12.0 12.0 600.0 1.95340754 0.000766473358028827 28812.0; 12.0 12.0 700.0 2.2533848595999997 0.0006568425509302885 33612.0; 12.0 12.0 800.0 2.5474632994 0.0005746486685435259 38412.0; 12.0 12.0 900.0 2.6033851398 0.000510737489698518 43164.0; 12.0 12.0 1000.0 3.1100802801999996 0.00045961953904660166 47964.0; 12.0 12.0 1100.0 3.1547012604 0.0004178030436897954 52764.0; 12.0 12.0 1200.0 3.6144525203999995 0.00038296097823403556 57564.0; 12.0 12.0 1300.0 3.8355636398 0.0003534827941597776 62364.0; 12.0 12.0 1400.0 4.1059638398 0.0003282183813490465 67164.0; 12.0 12.0 1500.0 4.5569375404 0.0003063245009497288 71964.0]

RK4_ad_N=[12.0 12.0 3.1622776601683795e-5 0.5129648197999999 0.00013038167166931242 8173.2; 12.0 12.0 1.0000000000000003e-5 0.5530943394 5.197030859205174e-5 9499.2; 12.0 12.0 3.162277660168379e-6 0.6928756006 2.2985059882457585e-5 11341.2; 12.0 12.0 1.0000000000000004e-6 0.8246019594 7.937098104276532e-6 13272.0; 12.0 12.0 3.162277660168379e-7 0.9051165196000002 3.217073013229464e-6 15610.8; 12.0 12.0 1.0000000000000004e-7 1.3080495396 1.1889505393615664e-6 18682.8; 12.0 12.0 3.162277660168379e-8 1.2429271402 4.0309423774023025e-7 22579.2; 12.0 12.0 1.0000000000000004e-8 1.6041916391999997 1.5948466403154094e-7 27222.0; 12.0 12.0 3.1622776601683795e-9 1.9868984400000003 5.2059679777365776e-8 33453.6; 12.0 12.0 1.0000000000000009e-9 2.3276559806000003 2.0729414050735685e-8 40596.0; 12.0 12.0 3.1622776601683795e-10 2.6900781396 7.605222540663885e-9 50026.8; 12.0 12.0 1.0000000000000006e-10 3.5506195399999996 2.6617435819512903e-9 62373.6; 12.0 12.0 3.1622776601683794e-11 4.2462885402 9.785422199808303e-10 76974.0; 12.0 12.0 1.0000000000000006e-11 5.6066018803999995 2.810944760282263e-10 97972.8; 12.0 12.0 3.1622776601683794e-12 6.8812163802 1.0135400548067137e-10 122403.6]

T5_ad_N=[12.0 12.0 3.1622776601683795e-5 0.3587550808000004 0.011604987153255687 2822.4; 12.0 12.0 1.0000000000000003e-5 0.3129760002 0.00014998948320653094 4333.2; 12.0 12.0 3.162277660168379e-6 0.3687786996 0.00021308037820151466 5515.2; 12.0 12.0 1.0000000000000004e-6 0.4387381598 0.0001095543825957144 6588.0; 12.0 12.0 3.162277660168379e-7 0.4778063402 4.170230677374082e-6 7765.2; 12.0 12.0 1.0000000000000004e-7 0.55645254 3.2546911040002596e-5 9219.6; 12.0 12.0 3.162277660168379e-8 0.6225905 2.9151215986663033e-6 10603.2; 12.0 12.0 1.0000000000000004e-8 0.6787464998 8.577780417621286e-7 12184.8; 12.0 12.0 3.1622776601683795e-9 0.7863703801999999 6.591357320858011e-7 14316.0; 12.0 12.0 1.0000000000000009e-9 0.8705776006000001 2.521632219603265e-7 15978.0; 12.0 12.0 3.1622776601683795e-10 1.01702018 8.492285950988787e-8 18847.2; 12.0 12.0 1.0000000000000006e-10 1.1735156602 3.1592286371663943e-8 21720.0; 12.0 12.0 3.1622776601683794e-11 1.3721652198 2.6501352782459258e-8 25238.4; 12.0 12.0 1.0000000000000006e-11 1.6609481202 1.904954997789831e-9 29366.4; 12.0 12.0 3.1622776601683794e-12 1.8850501204 4.2819787226393616e-10 34209.6]

RK4_G_ad_N=[100.0 1.0e-5 3.1622776601683795e-5 0.78720104 0.00011073175366708726 8125.2; 100.0 1.0e-5 1.0000000000000003e-5 0.8494045198 4.6891050915157956e-5 9346.8; 100.0 1.0e-5 3.162277660168379e-6 0.92462018 1.8053516702347414e-5 11449.2; 100.0 1.0e-5 1.0000000000000004e-6 1.00240704 7.539596643700101e-6 13328.4; 100.0 1.0e-5 3.162277660168379e-7 1.09680362 3.3913537422562105e-6 15777.6; 100.0 1.0e-5 1.0000000000000004e-7 1.3049557598000001 1.0481443770183615e-6 18859.2; 100.0 1.0e-5 3.162277660168379e-8 1.4061041199999997 4.0369002313324486e-7 22888.8; 100.0 1.0e-5 1.0000000000000004e-8 1.5875014799999998 1.6861534781561225e-7 27416.4; 100.0 1.0e-5 3.1622776601683795e-9 2.0024483202 6.324861819876164e-8 33434.4; 100.0 1.0e-5 1.0000000000000009e-9 2.4277431802000002 1.8432863893656535e-8 41037.6; 100.0 1.0e-5 3.1622776601683795e-10 3.02896564 7.861327294678382e-9 50391.6; 100.0 1.0e-5 1.0000000000000006e-10 3.1128780002 2.422519242903045e-9 62493.6; 100.0 1.0e-5 3.1622776601683794e-11 4.1147499203999995 8.799445535420968e-10 78465.6; 100.0 1.0e-5 1.0000000000000006e-11 4.8753170196 3.262097933823109e-10 97689.6; 100.0 1.0e-5 3.1622776601683794e-12 6.2036230398 1.1702555977374757e-10 124180.8]

T5_G_ad_N=[100.0 1.0e-5 3.1622776601683795e-5 0.60817408 0.000615940299507052 2863.2; 100.0 1.0e-5 1.0000000000000003e-5 0.7687367206 0.0005000038626771908 4341.6; 100.0 1.0e-5 3.162277660168379e-6 0.7256498201999999 0.0004728147371956435 5464.8; 100.0 1.0e-5 1.0000000000000004e-6 0.7678490596 7.647087472686159e-5 6824.4; 100.0 1.0e-5 3.162277660168379e-7 0.8261173596000001 7.686172091199752e-5 7966.8; 100.0 1.0e-5 1.0000000000000004e-7 0.8538777796 5.929495583016873e-6 9230.4; 100.0 1.0e-5 3.162277660168379e-8 0.9225224595999999 8.058921968990593e-6 10801.2; 100.0 1.0e-5 1.0000000000000004e-8 0.9793192 1.329405419359733e-6 12494.4; 100.0 1.0e-5 3.1622776601683795e-9 1.04809824 1.8404076389806413e-7 14110.8; 100.0 1.0e-5 1.0000000000000009e-9 1.1484744804 5.866159529120893e-8 16308.0; 100.0 1.0e-5 3.1622776601683795e-10 1.2657629 8.563776782240413e-8 19048.8; 100.0 1.0e-5 1.0000000000000006e-10 1.3982918999999998 1.573841045561341e-8 21856.8; 100.0 1.0e-5 3.1622776601683794e-11 1.56486428 1.1530730036307236e-8 25221.6; 100.0 1.0e-5 1.0000000000000006e-11 1.84935234 4.2781847009878584e-9 29486.4; 100.0 1.0e-5 3.1622776601683794e-12 1.9005155998000003 1.4540839801495482e-9 33991.2]

RK4_C_ad_N=[100.0 1.0e-5 3.1622776601683795e-5 1.8349171602000007 0.00033581954392925516 9055.2; 100.0 1.0e-5 1.0000000000000003e-5 2.3618562 0.000108754531756845 10538.4; 100.0 1.0e-5 3.162277660168379e-6 2.6613812796 4.8625107615369737e-5 12882.0; 100.0 1.0e-5 1.0000000000000004e-6 3.20669028 1.8759661997988495e-5 16068.0; 100.0 1.0e-5 3.162277660168379e-7 3.6953781402 6.1393534782085455e-6 19189.2; 100.0 1.0e-5 1.0000000000000004e-7 4.713962820200001 2.5433614459146968e-6 23923.2; 100.0 1.0e-5 3.162277660168379e-8 5.8083269196 9.072754903124751e-7 29778.0; 100.0 1.0e-5 1.0000000000000004e-8 7.0892127998 2.9713922075486835e-7 35900.4; 100.0 1.0e-5 3.1622776601683795e-9 9.5355438402 1.1548377990859436e-7 45090.0; 100.0 1.0e-5 1.0000000000000009e-9 11.2043659198 4.32946908050466e-8 55670.4; 100.0 1.0e-5 3.1622776601683795e-10 14.016401739600003 1.4533611826454105e-8 69770.4; 100.0 1.0e-5 1.0000000000000006e-10 19.123512260800002 5.7744441903652685e-9 87384.0; 100.0 1.0e-5 3.1622776601683794e-11 21.6965264002 2.1870006417417255e-9 109766.4; 100.0 1.0e-5 1.0000000000000006e-11 26.53700982 7.94691812411868e-10 136621.2; 100.0 1.0e-5 3.1622776601683794e-12 33.04479679999999 2.6231489952012767e-10 173774.4]

RK4_C_ad_N_norm=[100.0 1.0e-5 3.1622776601683795e-5 3.7372004005 4.285089036745226e-5 11859.0; 100.0 1.0e-5 1.0000000000000003e-5 2.98347775 1.503298792439209e-5 14136.0; 100.0 1.0e-5 3.162277660168379e-6 3.46485865 5.472418936343397e-6 17070.0; 100.0 1.0e-5 1.0000000000000004e-6 4.18225005 2.2664033065519258e-6 20556.0; 100.0 1.0e-5 3.162277660168379e-7 5.1561315005 8.035431390469408e-7 24753.0; 100.0 1.0e-5 1.0000000000000004e-7 6.0462993 3.5369245936113103e-7 30150.0; 100.0 1.0e-5 3.162277660168379e-8 7.5754636995 1.2741170209813428e-7 36657.0; 100.0 1.0e-5 1.0000000000000004e-8 9.107398499999999 3.598802820666831e-8 45219.0; 100.0 1.0e-5 3.1622776601683795e-9 10.978744149499999 1.519471282484874e-8 55113.0; 100.0 1.0e-5 1.0000000000000009e-9 13.4284788995 5.275467327916607e-9 68616.0; 100.0 1.0e-5 3.1622776601683795e-10 17.0031764995 2.215975776775309e-9 85314.0; 100.0 1.0e-5 1.0000000000000006e-10 20.89219745 8.912882442392247e-10 108408.0; 100.0 1.0e-5 3.1622776601683794e-11 27.79126045 3.1543889264840455e-10 135696.0; 100.0 1.0e-5 1.0000000000000006e-11 33.2436261 8.921087205565303e-11 172269.0; 100.0 1.0e-5 3.1622776601683794e-12 40.909798851000005 3.361605613485902e-11 217119.0]

T5_C_ad_N=[100.0 1.0e-5 3.1622776601683795e-5 0.4039254602 0.006618759430713747 3027.6; 100.0 1.0e-5 1.0000000000000003e-5 0.9430002600000001 0.0005657681232557466 4276.8; 100.0 1.0e-5 3.162277660168379e-6 1.17478242 0.00050731323907648 5498.4; 100.0 1.0e-5 1.0000000000000004e-6 1.4867464798 9.130169527683822e-5 7155.6; 100.0 1.0e-5 3.162277660168379e-7 1.77958462 3.328841923519625e-5 8736.0; 100.0 1.0e-5 1.0000000000000004e-7 2.1331267598 1.6775853203076276e-5 10168.8; 100.0 1.0e-5 3.162277660168379e-8 2.4283373998 3.4308994650993284e-7 12163.2; 100.0 1.0e-5 1.0000000000000004e-8 2.8925016 9.424225674704147e-8 14169.6; 100.0 1.0e-5 3.1622776601683795e-9 3.3984395800000002 3.176902639049562e-7 16792.8; 100.0 1.0e-5 1.0000000000000009e-9 3.8932882397999995 1.9611399594326498e-7 19323.6; 100.0 1.0e-5 3.1622776601683795e-10 4.5841828998 9.339469444153312e-9 23047.2; 100.0 1.0e-5 1.0000000000000006e-10 5.3432529798 3.086323230997339e-8 27168.0; 100.0 1.0e-5 3.1622776601683794e-11 6.3065088000000005 7.0896424192632906e-9 31760.4; 100.0 1.0e-5 1.0000000000000006e-11 7.6553448799999995 4.495629219337345e-9 38409.6; 100.0 1.0e-5 3.1622776601683794e-12 9.4359718402 1.1937725105273455e-9 45456.0]


#Plots.plot(hcat(RK4_fix_N[:,6],T5_ad_N[:,6],T5_G_ad_N[:,6],T5_C_ad_N[:,6]),hcat(RK4_fix_N[:,5],T5_ad_N[:,5],T5_G_ad_N[:,5],T5_C_ad_N[:,5]),xscale=:log10,yscale=:log10,label=["RK4 naive" "T5 ad" "T5 G ad" "T5 C ad"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.plot(hcat(RK4_fix_N[:,6],RK4_ad_N[:,6],RK4_G_ad_N[:,6],RK4_C_ad_N_norm[:,6],T5_G_ad_N[:,6]),hcat(RK4_fix_N[:,5],RK4_ad_N[:,5],RK4_G_ad_N[:,5],RK4_C_ad_N_norm[:,5],T5_G_ad_N[:,5]),xscale=:log10,yscale=:log10,label=["RK4 naive" "RK4 ad" "RK4 G ad" "RK4 C ad"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.plot(hcat(RK4_fix_N[:,4],RK4_ad_N[:,4],RK4_G_ad_N[:,4],RK4_C_ad_N_norm[:,4],T5_G_ad_N[:,4]),hcat(RK4_fix_N[:,5],RK4_ad_N[:,5],RK4_G_ad_N[:,5],RK4_C_ad_N_norm[:,5],T5_G_ad_N[:,5]),xscale=:log10,yscale=:log10,label=["RK4 naive" "RK4 ad" "RK4 G ad" "RK4 C ad" "T5 G ad"],markershapes= [:circle],xlabel = "CPU time",ylabel = "eigenvalue error")

Plots.savefig("1.pdf")
println(A_RK4_T)
