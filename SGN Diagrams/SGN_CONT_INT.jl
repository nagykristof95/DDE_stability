using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

#SMOOTH
A_RK4_m_S=[100.0 1.0e-5 1.0e-5 3.4625237 7.170791219190704e-6 4860.0; 200.0 1.0e-5 1.0e-5 2.4908497670000003 4.4721246407438276e-7 9660.0; 300.0 1.0e-5 1.0e-5 2.857123566666667 8.847183459043892e-8 14460.0; 400.0 1.0e-5 1.0e-5 3.4869081666666664 2.8046122715647424e-8 19260.0; 500.0 1.0e-5 1.0e-5 4.552340699999999 1.154823135058724e-8 24012.0; 600.0 1.0e-5 1.0e-5 5.315714433666667 5.5618745537656415e-9 28812.0; 700.0 1.0e-5 1.0e-5 6.398714533000001 3.0070402929284905e-9 33660.0; 800.0 1.0e-5 1.0e-5 7.225469199666667 1.7881813341858727e-9 38412.0; 900.0 1.0e-5 1.0e-5 8.287602066333333 1.1041719478411011e-9 43260.0; 1000.0 1.0e-5 1.0e-5 9.354207699666667 7.191942544456692e-10 48060.0; 1100.0 1.0e-5 1.0e-5 9.817652666666667 4.903573238645436e-10 52812.0; 1200.0 1.0e-5 1.0e-5 11.056650166666666 3.4618148452540506e-10 57660.0; 1300.0 1.0e-5 1.0e-5 11.658188933 2.532057089579918e-10 62460.0; 1400.0 1.0e-5 1.0e-5 13.314944000333334 1.88500707235722e-10 67212.0; 1500.0 1.0e-5 1.0e-5 14.348296133333335 1.4287330216773778e-10 72060.0]

A_RK4_T_S=[100.0 1.0e-5 0.1 1.450709466666667 0.1586435938194026 918.0; 100.0 1.0e-5 0.01 0.3693089 0.03533038554709309 1496.0; 100.0 1.0e-5 0.001 0.6110260003333333 0.00541228945963605 2848.0; 100.0 1.0e-5 0.0001 0.9097418999999999 0.0008626546115469608 4460.0; 100.0 1.0e-5 1.0e-5 1.3767143333333334 0.00012514255914794067 6736.0; 100.0 1.0e-5 1.0e-6 2.2448227333333333 1.6230902682459344e-5 11216.0; 100.0 1.0e-5 1.0e-7 3.5672289996666664 2.1946840990752465e-6 18276.0; 100.0 1.0e-5 1.0e-8 6.131393299666667 2.9103287296989536e-7 30098.0; 100.0 1.0e-5 1.0e-9 9.724290133 3.845642939950516e-8 48120.0; 100.0 1.0e-5 1.0e-10 16.564321267 5.074296710325169e-9 79202.0; 100.0 1.0e-5 1.0e-11 27.914308900333328 6.802108163856422e-10 127806.0; 100.0 1.0e-5 1.0e-12 43.20015189966667 9.26306047063969e-11 208904.0]

A_RK4_T_S_norm=[100.0 1.0e-5 0.1 0.3800171993333333 0.026979082394429327 1534.0; 100.0 1.0e-5 0.01 0.5375450333333334 0.004895274523912579 2378.0; 100.0 1.0e-5 0.001 0.7618097330000001 0.0008078506507302363 3648.0; 100.0 1.0e-5 0.0001 1.1182863336666664 0.000122887942693187 5602.0; 100.0 1.0e-5 1.0e-5 1.7156103003333332 1.7129756585775182e-5 8936.0; 100.0 1.0e-5 1.0e-6 2.811967832666667 2.2752576814144606e-6 14390.0; 100.0 1.0e-5 1.0e-7 4.523771866333334 3.044474308419374e-7 23050.0; 100.0 1.0e-5 1.0e-8 7.338575733666667 4.002697011736571e-8 37246.0; 100.0 1.0e-5 1.0e-9 12.0005259 5.277275522146412e-9 60262.0; 100.0 1.0e-5 1.0e-10 19.511744400333335 7.00755529703484e-10 99356.0; 100.0 1.0e-5 1.0e-11 31.221975599666667 9.362858648391057e-11 162558.0; 100.0 1.0e-5 1.0e-12 50.691154100333335 1.3474335533290596e-11 266632.0]
println(A_RK4_T)

A_RK4_TA_S=[100.0 1.0e-5 0.1 5.396898533666666 0.27866582734893625 990.0; 100.0 1.0e-5 0.01 0.3911769333333333 0.045292748679139384 1612.0; 100.0 1.0e-5 0.001 0.6446530336666667 0.007956392788632123 2952.0; 100.0 1.0e-5 0.0001 0.9531417663333333 0.001159188948491285 4532.0; 100.0 1.0e-5 1.0e-5 1.4803434663333332 0.00019026544318592918 7198.0; 100.0 1.0e-5 1.0e-6 2.3909342666666666 3.0364398867747475e-5 11422.0; 100.0 1.0e-5 1.0e-7 4.223520266666666 4.245217551005506e-6 17549.0; 100.0 1.0e-5 1.0e-8 6.104295367 6.740939598780052e-7 29489.0; 100.0 1.0e-5 1.0e-9 10.792501267 1.0754088277357873e-7 47235.0; 100.0 1.0e-5 1.0e-10 16.542203133 1.6611861138004337e-8 75533.0; 100.0 1.0e-5 1.0e-11 26.000219500333333 2.598892081970013e-9 122435.0; 100.0 1.0e-5 1.0e-12 37.508017599666665 4.1638214153302353e-10 196473.0]

A_RK4_ad_S=[12.0 12.0 0.1 1.312102133 0.11277822404730775 850.0; 12.0 12.0 0.01 0.18078929966666668 0.022504904717756406 1182.0; 12.0 12.0 0.001 0.18768843300000002 0.0035738521833168094 1766.0; 12.0 12.0 0.0001 0.25498493400000005 0.0005079383962278645 2778.0; 12.0 12.0 1.0e-5 0.36534599966666664 6.78933718336321e-5 4350.0; 12.0 12.0 1.0e-6 0.5633126669999999 8.590389143431328e-6 7386.0; 12.0 12.0 1.0e-7 0.785847767 1.1249574173036306e-6 11878.0; 12.0 12.0 1.0e-8 1.2899266 1.4483674172691235e-7 19732.0; 12.0 12.0 1.0e-9 2.0871652333333333 1.8197755720833872e-8 32754.0; 12.0 12.0 1.0e-10 3.1618809996666664 2.311310362930353e-9 53884.0; 12.0 12.0 1.0e-11 5.109313900333333 2.99643423908186e-10 89112.0; 12.0 12.0 1.0e-12 8.081509100333333 3.945000871336309e-11 147670.0]

Plots.plot(A_RK4_m_S[:,6],A_RK4_m_S[:,5],xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label="fixed step",markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")
Plots.plot!(hcat(A_RK4_T_S_norm[:,6],A_RK4_TA_S[:,6],A_RK4_ad_S[:,6]),hcat(A_RK4_T_S_norm[:,5],A_RK4_TA_S[:,5],A_RK4_ad_S[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["ad tol" "ad array" "ad naive"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

#NON-SMOOTH
A_RK4_m_NS=[100.0 1.0e-5 1.0e-5 1.9798355663333336 0.009199974484374812 4860.0; 200.0 1.0e-5 1.0e-5 1.7174199993333332 0.004595022254738944 9660.0; 300.0 1.0e-5 1.0e-5 2.5693393663333333 0.0030626649059129793 14460.0; 400.0 1.0e-5 1.0e-5 3.644930999666667 9.730774831985765e-7 19260.0; 500.0 1.0e-5 1.0e-5 4.4279315336666665 6.317428009142785e-7 24012.0; 600.0 1.0e-5 1.0e-5 5.331624666666667 0.0015309977803347392 28812.0; 700.0 1.0e-5 1.0e-5 6.300260600333334 0.0013122519832665447 33660.0; 800.0 1.0e-5 1.0e-5 7.228532600333334 0.0011479036344552687 38412.0; 900.0 1.0e-5 1.0e-5 7.989251966333334 0.0010206063514040908 43260.0; 1000.0 1.0e-5 1.0e-5 8.846062733000002 0.000918536815515093 48060.0; 1100.0 1.0e-5 1.0e-5 9.872835766666666 0.0008348664042841651 52812.0; 1200.0 1.0e-5 1.0e-5 10.843907033333332 1.0626485987250145e-7 57660.0; 1300.0 1.0e-5 1.0e-5 11.811524333333333 0.0007065501672627808 62460.0; 1400.0 1.0e-5 1.0e-5 14.139524699666666 0.0006559807988373297 67212.0; 1500.0 1.0e-5 1.0e-5 14.929206833333334 0.0006122521714857197 72060.0]

A_RK4_T_NS=[100.0 1.0e-5 0.1 0.28958680000000003 0.09195822231985132 988.0; 100.0 1.0e-5 0.01 0.5868687 0.01897612893061557 2634.0; 100.0 1.0e-5 0.001 1.1128815336666669 0.005611872365685346 4734.0; 100.0 1.0e-5 0.0001 1.6175092003333333 0.0007799026137319309 7154.0; 100.0 1.0e-5 1.0e-5 2.4812297 0.00011809002176043513 10580.0; 100.0 1.0e-5 1.0e-6 3.6655767666666663 1.7281503104592457e-5 16078.0; 100.0 1.0e-5 1.0e-7 5.506915933666666 2.6924858981597546e-6 23888.0; 100.0 1.0e-5 1.0e-8 8.196731133999998 3.0964720637543655e-7 35694.0; 100.0 1.0e-5 1.0e-9 12.235561232666667 4.390824899242522e-8 55818.0; 100.0 1.0e-5 1.0e-10 19.114342799666666 5.813162571191428e-9 88084.0; 100.0 1.0e-5 1.0e-11 26.739129833000003 7.966648709509039e-10 135558.0; 100.0 1.0e-5 1.0e-12 43.82035269966667 1.0197693409318909e-10 219004.0]

A_RK4_T_NS_norm=[100.0 1.0e-5 0.1 1.430959367 0.012252582110887457 2098.0; 100.0 1.0e-5 0.01 0.9350441333333334 0.0010416382098761548 4480.0; 100.0 1.0e-5 0.001 1.4245747006666667 0.0005351321669867173 6826.0; 100.0 1.0e-5 0.0001 2.1864958666666667 8.147197775887257e-5 9910.0; 100.0 1.0e-5 1.0e-5 2.9307006673333333 1.666051190903766e-5 14142.0; 100.0 1.0e-5 1.0e-6 4.337109366666667 2.2144221965903595e-6 20462.0; 100.0 1.0e-5 1.0e-7 6.127781966666666 2.2166405934466059e-7 29886.0; 100.0 1.0e-5 1.0e-8 9.3314576 3.8732110149543046e-8 44776.0; 100.0 1.0e-5 1.0e-9 14.350362067 4.936210155734145e-9 68882.0; 100.0 1.0e-5 1.0e-10 22.93446910066667 8.337953945514444e-10 107820.0; 100.0 1.0e-5 1.0e-11 34.075152100333334 1.0735367391655756e-10 171286.0; 100.0 1.0e-5 1.0e-12 59.06250139966667 1.3409739804690822e-11 274304.0]

A_RK4_TA_NS=[100.0 1.0e-5 0.1 2.266195533 0.28459463163135146 1002.0; 100.0 1.0e-5 0.01 0.3922094666666667 0.0648345456206467 1600.0; 100.0 1.0e-5 0.001 0.6682888 0.014494153030814931 2982.0; 100.0 1.0e-5 0.0001 0.9975836 0.005226202988882233 4674.0; 100.0 1.0e-5 1.0e-5 1.6076443999999999 0.004180564715768325 7848.0; 100.0 1.0e-5 1.0e-6 2.490912167 0.00012695742826975497 12408.0; 100.0 1.0e-5 1.0e-7 3.6643563 0.0015573320656899808 18837.0; 100.0 1.0e-5 1.0e-8 5.979814233333333 0.00013773280422272975 31083.0; 100.0 1.0e-5 1.0e-9 9.663935533333333 0.00015517295801529182 49593.0; 100.0 1.0e-5 1.0e-10 15.655267533333335 7.44985999678419e-6 78119.0; 100.0 1.0e-5 1.0e-11 23.865156900000002 2.4652871217640176e-5 124225.0; 100.0 1.0e-5 1.0e-12 42.56852179966666 1.4562051175732594e-6 201719.0]

A_RK4_ad_NS=[12.0 12.0 0.1 2.146652700333333 0.07426694053462471 1090.0; 12.0 12.0 0.01 0.31770893400000005 0.021951523743515396 2998.0; 12.0 12.0 0.001 0.3488393 0.0004925563344629982 4736.0; 12.0 12.0 0.0001 0.49133356666666667 0.00023561851516080623 6884.0; 12.0 12.0 1.0e-5 0.6454242663333334 4.833527470721835e-5 9534.0; 12.0 12.0 1.0e-6 0.8398325333333334 9.219582817890716e-6 13036.0; 12.0 12.0 1.0e-7 1.1823069663333332 9.022012797053201e-7 18450.0; 12.0 12.0 1.0e-8 1.7769269663333331 1.6081654991309012e-7 27284.0; 12.0 12.0 1.0e-9 2.6935381993333336 2.0133087976409418e-8 40994.0; 12.0 12.0 1.0e-10 3.7556479670000003 2.5476017579749714e-9 61910.0; 12.0 12.0 1.0e-11 6.006955999666666 3.508066795804022e-10 97568.0; 12.0 12.0 1.0e-12 9.810456533333335 4.377290438348827e-11 155344.0]

Plots.plot(A_RK4_m_NS[:,6],A_RK4_m_NS[:,5],xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label="fixed step",markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")
Plots.plot!(hcat(A_RK4_T_NS_norm[:,6],A_RK4_TA_NS[:,6],A_RK4_ad_NS[:,6]),hcat(A_RK4_T_NS_norm[:,5],A_RK4_TA_NS[:,5],A_RK4_ad_NS[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["ad tol" "ad array" "ad naive"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.savefig("1.pdf")
println(A_RK4_T)
