using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

#point A quad

A_RK4_q=[12.0 12.0 100.0 1.4729872995 0.004621696913376797 4752.0; 12.0 12.0 200.0 0.7756203995 0.0023052626582143244 9552.0; 12.0 12.0 300.0 1.0135614505000001 0.0015349738666026634 14352.0; 12.0 12.0 400.0 1.3426641505 0.0011504727470490969 19152.0; 12.0 12.0 500.0 1.6640263505 0.000920003015068425 23952.0; 12.0 12.0 600.0 2.0030848505 0.0007664573485016071 28752.0; 12.0 12.0 700.0 2.3670910995 0.0006568324849747893 33552.0; 12.0 12.0 800.0 2.6186221495 0.0005746419330102014 38352.0; 12.0 12.0 900.0 2.83023475 0.0005107327635753738 43152.0; 12.0 12.0 1000.0 3.0609573505 0.0004596160963531454 47952.0; 12.0 12.0 1100.0 3.2706957489999997 0.00041780045879331374 52752.0; 12.0 12.0 1200.0 3.47294165 0.0003829589880961444 57552.0; 12.0 12.0 1300.0 3.8796385005 0.00035348122957006673 62352.0; 12.0 12.0 1400.0 4.1383602495 0.0003282171291464649 67152.0; 12.0 12.0 1500.0 4.3881121005 0.00030632348322524736 71952.0]

A_RK3_q=[12.0 12.0 100.0 0.26256965 0.00474956955720576 3564.0; 12.0 12.0 200.0 0.5742913005 0.0023177660700641057 7164.0; 12.0 12.0 300.0 0.872841949 0.0015383842892884988 10764.0; 12.0 12.0 400.0 1.1229676005 0.0011518535345223116 14364.0; 12.0 12.0 500.0 1.7068674495 0.0009206928410302985 17964.0; 12.0 12.0 600.0 1.7484157 0.0007668501050477195 21564.0; 12.0 12.0 700.0 1.8182103005 0.0006570769684280781 25164.0; 12.0 12.0 800.0 2.4515547494999996 0.0005748043042800239 28764.0; 12.0 12.0 900.0 2.2074724989999996 0.0005108460376375055 32364.0; 12.0 12.0 1000.0 2.7479795495 0.00045969823083705414 35964.0; 12.0 12.0 1100.0 2.9966468500000003 0.000417861897509556 39564.0; 12.0 12.0 1200.0 3.0486609505000004 0.00038300613908462 43164.0; 12.0 12.0 1300.0 4.278391000499999 0.0003535182008389113 46764.0; 12.0 12.0 1400.0 3.9708382505 0.00032824665230060185 50364.0; 12.0 12.0 1500.0 3.6929691504999997 0.0003063474317854416 53964.0]

A_RK2_q=[12.0 12.0 100.0 0.17852004999999999 0.02645887189121434 2376.0; 12.0 12.0 200.0 0.38854129950000005 0.010020871059693013 4776.0; 12.0 12.0 300.0 0.5699983495000001 0.0059789385588674745 7176.0; 12.0 12.0 400.0 0.8749469505 0.004222630610368841 9576.0; 12.0 12.0 500.0 1.0585597 0.003252944661637677 11976.0; 12.0 12.0 600.0 1.2841215505 0.0026413920610429535 14376.0; 12.0 12.0 700.0 1.4697228 0.0022216218246659545 16776.0; 12.0 12.0 800.0 1.4536971995 0.001916103439678096 19176.0; 12.0 12.0 900.0 1.6519771 0.001683987325887461 21576.0; 12.0 12.0 1000.0 1.9777419 0.001501761717452183 23976.0; 12.0 12.0 1100.0 2.1291705005 0.0013549585685155479 26376.0; 12.0 12.0 1200.0 2.1788216499999997 0.0012341962896934167 28776.0; 12.0 12.0 1300.0 2.19821985 0.0011331295999114938 31176.0; 12.0 12.0 1400.0 2.6211172 0.0010473154120891443 33576.0; 12.0 12.0 1500.0 2.5772392 0.0009735509554392694 35976.0]

A_RK1_q=[12.0 12.0 100.0 0.22541360049999998 0.4279984208752116 1188.0; 12.0 12.0 200.0 0.259408751 0.19135609450354696 2388.0; 12.0 12.0 300.0 0.3826050005 0.12304148154901669 3588.0; 12.0 12.0 400.0 0.5095654995000001 0.09064790496957184 4788.0; 12.0 12.0 500.0 0.6981735495 0.07175056036192097 5988.0; 12.0 12.0 600.0 0.8419052494999999 0.059371114007088506 7188.0; 12.0 12.0 700.0 1.1280432994999998 0.050634047907271655 8388.0; 12.0 12.0 800.0 1.1168486495 0.04413822047712778 9588.0; 12.0 12.0 900.0 1.247147 0.03911938196122071 10788.0; 12.0 12.0 1000.0 1.3345452500000001 0.035125258615079265 11988.0; 12.0 12.0 1100.0 1.2951889005 0.03187111601813016 13188.0; 12.0 12.0 1200.0 1.3654893995 0.029168761126332134 14388.0; 12.0 12.0 1300.0 1.5142902005 0.026888825485831894 15588.0; 12.0 12.0 1400.0 1.9512509995 0.02493944832497024 16788.0; 12.0 12.0 1500.0 1.5769568505 0.023253602616276303 17988.0]

Plots.plot(A_RK4_q[:,3],hcat(A_RK4_q[:,5],A_RK4_q[:,5],A_RK2_q[:,5],A_RK1_q[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["RK4" "RK3" "RK2" "EE"],markershapes= [:circle],xlabel = "number of steps",ylabel = "eigenvalue error",markerstrokewidth = 0,markersize = 5)

Plots.plot(hcat(A_RK4_q[:,6],A_RK4_q[:,6],A_RK2_q[:,6],A_RK1_q[:,6]),hcat(A_RK4_q[:,5],A_RK4_q[:,5],A_RK2_q[:,5],A_RK1_q[:,5]),xscale=:log10, yscale=:log10,title="Comparaison of methods A",label=["RK4" "RK3" "RK2" "EE"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error",markerstrokewidth = 0,markersize = 5)

open("temp.txt", "w") do io
           writedlm(io, A_RK1_q)
       end

Plots.savefig("1.pdf")
