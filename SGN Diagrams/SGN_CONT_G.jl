using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots


#SMOOTH SYSTEM integration tolerance
A_RK4_S6=[100.0 1.0e-7 0.1 0.44115629999999995 9.467643597855611e-5 7579.2; 100.0 1.0e-7 0.01 0.46170852 8.374174403688402e-6 7413.6; 100.0 1.0e-7 0.001 0.5338295002 8.635912478825918e-6 7453.2; 100.0 1.0e-7 0.0001 0.6159697804 8.59413280423797e-6 7474.8; 100.0 1.0e-7 1.0e-5 0.7399817197999999 8.373891242191936e-6 7462.8; 100.0 1.0e-7 1.0e-6 0.9048338396000002 8.86226881139779e-6 7446.0; 100.0 1.0e-7 1.0e-7 1.4134659598000001 8.475453861885963e-6 7464.0; 100.0 1.0e-7 1.0e-8 2.18585982 8.513830643722904e-6 7468.8; 100.0 1.0e-7 1.0e-9 3.3615648998 8.514252508248738e-6 7473.6; 100.0 1.0e-7 1.0e-10 4.74816406 8.495638794103105e-6 7426.8; 100.0 1.0e-7 1.0e-11 6.412249739799999 8.50052450164367e-6 7432.8; 100.0 1.0e-7 1.0e-12 8.383113360200001 8.499738898211044e-6 7431.6]

A_RK4_S7=[100.0 1.0e-7 0.1 0.6788784800000001 1.0966729273605931e-6 12043.2; 100.0 1.0e-7 0.01 0.6827619398 9.90308730271496e-7 11998.8; 100.0 1.0e-7 0.001 0.7658275598 1.0777083489289051e-6 11983.2; 100.0 1.0e-7 0.0001 0.8830091596 1.1120686046112115e-6 12022.8; 100.0 1.0e-7 1.0e-5 1.0971520602 1.140015234927775e-6 12092.4; 100.0 1.0e-7 1.0e-6 1.2987965399999999 1.107392529366941e-6 12079.2; 100.0 1.0e-7 1.0e-7 1.4001132998 1.11993490413072e-6 11977.2; 100.0 1.0e-7 1.0e-8 2.0656825 1.08284685398068e-6 11934.0; 100.0 1.0e-7 1.0e-9 3.3108499399999998 1.094149466211124e-6 12109.2; 100.0 1.0e-7 1.0e-10 4.918192639999999 1.0863816393185353e-6 12105.6; 100.0 1.0e-7 1.0e-11 7.231676479800001 1.0824191760288454e-6 12079.2; 100.0 1.0e-7 1.0e-12 9.91324174 1.0887600874484394e-6 11998.8]

A_RK4_S8=[100.0 1.0e-7 0.1 1.0647273598 1.3908444998995903e-7 19958.4; 100.0 1.0e-7 0.01 1.0479365399999998 1.3726660442379922e-7 20023.2; 100.0 1.0e-7 0.001 1.1078434996 1.447380551755496e-7 20022.0; 100.0 1.0e-7 0.0001 1.2366985998 1.3958829670407889e-7 19934.4; 100.0 1.0e-7 1.0e-5 1.5748425004000002 1.270349504458445e-7 19999.2; 100.0 1.0e-7 1.0e-6 1.4807539003999999 1.3788913720415354e-7 20112.0; 100.0 1.0e-7 1.0e-7 2.2749943004000004 1.3478389083329984e-7 20095.2; 100.0 1.0e-7 1.0e-8 2.05622022 1.4553725190928796e-7 20066.4; 100.0 1.0e-7 1.0e-9 3.3771736802 1.3881748591353938e-7 19984.8; 100.0 1.0e-7 1.0e-10 4.9877344598 1.400783791750463e-7 19972.8; 100.0 1.0e-7 1.0e-11 7.4771217000000005 1.3839766617441115e-7 19996.8; 100.0 1.0e-7 1.0e-12 11.428918360199999 1.393352676534939e-7 19861.2]

Plots.plot(A_RK4_S6[:,3],hcat(A_RK4_S6[:,5],A_RK4_S7[:,5],A_RK4_S8[:,5]),xscale=:log10, yscale=:log10,label=["tol 6" "tol 7" "tol 8"],markershapes= [:circle])

#NON-SMOOTH SYSTEM integration tolerance
A_RK4_NS6=[100.0 1.0e-7 0.1 1.9090439402000001 0.010369586776181598 13370.4; 100.0 1.0e-7 0.01 1.08002376 0.0006321503923050947 13342.8; 100.0 1.0e-7 0.001 0.9660814993999999 6.8389070307209734e-6 13336.8; 100.0 1.0e-7 0.0001 0.9849900804 9.331686057041446e-6 13264.8; 100.0 1.0e-7 1.0e-5 1.1107325996 6.783346276708308e-6 13297.2; 100.0 1.0e-7 1.0e-6 1.5176851996 7.622507688194063e-6 13298.4; 100.0 1.0e-7 1.0e-7 1.86563886 7.094840367209574e-6 13420.8; 100.0 1.0e-7 1.0e-8 2.8358310795999997 7.911909209137067e-6 13381.2; 100.0 1.0e-7 1.0e-9 4.3319205002 8.223521902104745e-6 13339.2; 100.0 1.0e-7 1.0e-10 5.3325786802 7.751251240618893e-6 13192.8; 100.0 1.0e-7 1.0e-11 7.9248935402 7.147613412266677e-6 13399.2; 100.0 1.0e-7 1.0e-12 9.8854544798 8.676162470892777e-6 13287.6]

A_RK4_NS7=[100.0 1.0e-7 0.1 1.00155382 1.0924575139824302e-6 18954.0; 100.0 1.0e-7 0.01 1.0241756399999997 0.0007000929356102963 18732.0; 100.0 1.0e-7 0.001 1.0823916994 1.2004699206148774e-6 18817.2; 100.0 1.0e-7 0.0001 1.1888531599999999 1.3352633158774698e-6 19068.0; 100.0 1.0e-7 1.0e-5 1.3060721601999998 1.1944758985403403e-6 18829.2; 100.0 1.0e-7 1.0e-6 1.4396833004 1.0884633273235339e-6 18950.4; 100.0 1.0e-7 1.0e-7 1.6470192000000001 1.1310005051500746e-6 18735.6; 100.0 1.0e-7 1.0e-8 2.37457314 1.0751013639262022e-6 18882.0; 100.0 1.0e-7 1.0e-9 3.5686091598000003 1.1069176063492968e-6 18889.2; 100.0 1.0e-7 1.0e-10 5.909254499599999 1.142222681565419e-6 18658.8; 100.0 1.0e-7 1.0e-11 7.631630079999999 9.886970120769444e-7 18951.6; 100.0 1.0e-7 1.0e-12 11.431723920200001 1.2123165245290081e-6 18679.2]

A_RK4_NS8=[100.0 1.0e-7 0.1 1.4099738806000002 1.4679081016952537e-7 27466.8; 100.0 1.0e-7 0.01 1.4921185395999998 0.0005023521717976711 27600.0; 100.0 1.0e-7 0.001 1.53825462 0.0030398079052087377 27554.4; 100.0 1.0e-7 0.0001 1.7275020399999998 1.533764400633405e-7 27494.4; 100.0 1.0e-7 1.0e-5 1.7482092599999999 1.6475768792595027e-7 27385.2; 100.0 1.0e-7 1.0e-6 1.8419377399999999 1.6690108798137194e-7 27540.0; 100.0 1.0e-7 1.0e-7 2.0162627800000004 1.599845592607913e-7 27388.8; 100.0 1.0e-7 1.0e-8 2.1070073396 1.3198591474588107e-7 27508.8; 100.0 1.0e-7 1.0e-9 3.4136918199999995 1.514797189785326e-7 27444.0; 100.0 1.0e-7 1.0e-10 5.5739236598 1.4049274825201898e-7 27546.0; 100.0 1.0e-7 1.0e-11 9.9611319598 1.2703669558646553e-7 27271.2; 100.0 1.0e-7 1.0e-12 12.103263760399999 1.4899645092639957e-7 27661.2]

Plots.plot(A_RK4_NS6[:,3],hcat(A_RK4_NS6[:,5],A_RK4_NS7[:,5],A_RK4_NS8[:,5]),xscale=:log10, yscale=:log10,label=["tol 6" "tol 7" "tol 8"],markershapes= [:circle])

#SAMPLING COMPARISON

#NON-SMOOTH
println(A_RK4_DE_ad)
A_RK4_DE_NS6T=[1.0e-6 1.0e-6 10.0 1.5590177800000002 7.937031797945662e-6 159244.8; 1.0e-6 1.0e-6 260.0 0.8973795134666667 7.466202597616637e-6 159782.40000000002; 1.0e-6 1.0e-6 510.0 1.0248984602000002 7.79028447933208e-6 160243.2; 1.0e-6 1.0e-6 760.0 1.1440344664666668 7.819997804416985e-6 158280.0; 1.0e-6 1.0e-6 1010.0 1.17279074 7.842745947922432e-6 157987.2; 1.0e-6 1.0e-6 1260.0 1.2406736936 8.249875102076839e-6 158817.59999999998; 1.0e-6 1.0e-6 1510.0 1.33006874 8.677887860770912e-6 160008.0; 1.0e-6 1.0e-6 1760.0 1.459266506533333 8.245961186059203e-6 159436.8; 1.0e-6 1.0e-6 2010.0 1.5083981333333334 7.995958032223674e-6 158510.40000000002; 1.0e-6 1.0e-6 2260.0 1.6510767465333334 8.011446545569996e-6 159004.8; 1.0e-6 1.0e-6 2510.0 1.7353040132000002 8.28815590505188e-6 159456.0; 1.0e-6 1.0e-6 2760.0 1.8960902599999998 7.713788628120722e-6 159748.8]

A_RK4_NS6T=[100.0 1.0e-7 0.1 0.8302018731333333 0.008668905704928885 13481.6; 100.0 1.0e-7 0.01 0.8695316198666667 0.0004731773706003414 13355.6; 100.0 1.0e-7 0.001 0.8893884999333335 8.24689391173037e-6 13296.8; 100.0 1.0e-7 0.0001 1.0891559799333335 8.154411563993596e-6 13342.4; 100.0 1.0e-7 1.0e-5 1.1584671599999998 8.312450303342214e-6 13335.6; 100.0 1.0e-7 1.0e-6 1.2106156599999998 8.206903508398368e-6 13402.0; 100.0 1.0e-7 1.0e-7 1.7162629666666664 8.000675629278958e-6 13348.8; 100.0 1.0e-7 1.0e-8 3.1964398666 7.453502849587537e-6 13315.2; 100.0 1.0e-7 1.0e-9 4.232591480266667 8.377632519418649e-6 13282.4; 100.0 1.0e-7 1.0e-10 5.477427793200001 8.316217086810496e-6 13310.8; 100.0 1.0e-7 1.0e-11 7.683465726933333 8.12866817065527e-6 13348.4; 100.0 1.0e-7 1.0e-12 9.5326074668 7.476131811774879e-6 13293.2]

Plots.plot(A_RK4_DE_NS6T[:,4],A_RK4_DE_NS6T[:,5],xscale=:log10, yscale=:log10,label="ad",markershapes= [:circle])
Plots.plot!(A_RK4_NS6T[:,4],A_RK4_NS6T[:,5],xscale=:log10, yscale=:log10,label="ad+Gauss",markershapes= [:circle])

#SMOOTH
A_RK4_DE_S6T=[1.0e-6 1.0e-6 10.0 0.6917536066000001 8.709596359624117e-6 88867.20000000001; 1.0e-6 1.0e-6 260.0 0.5572655598666666 8.652350514600598e-6 88953.6; 1.0e-6 1.0e-6 510.0 0.6793169066666667 8.712668543038834e-6 89097.6; 1.0e-6 1.0e-6 760.0 0.8505933667333333 8.659153421669665e-6 88934.4; 1.0e-6 1.0e-6 1010.0 0.9191660403333335 8.662557544797424e-6 89102.4; 1.0e-6 1.0e-6 1260.0 0.9538949196666668 8.671604214205951e-6 88862.4; 1.0e-6 1.0e-6 1510.0 1.0605240003333332 8.71525345718513e-6 88843.20000000001; 1.0e-6 1.0e-6 1760.0 1.2059593867333334 8.666603931575562e-6 89088.0; 1.0e-6 1.0e-6 2010.0 1.2880768203333335 8.67408352363122e-6 88915.20000000001; 1.0e-6 1.0e-6 2260.0 1.4065452399999998 8.720689648611914e-6 88972.79999999999; 1.0e-6 1.0e-6 2510.0 1.462146827 8.702832980153375e-6 88939.20000000001; 1.0e-6 1.0e-6 2760.0 1.5667265868000002 8.674639671058557e-6 88953.6]

A_RK4_S6T=[100.0 1.0e-7 0.1 0.7250833800666666 8.831600768226762e-5 7570.4; 100.0 1.0e-7 0.01 0.6020999332666668 8.184347916197029e-6 7447.6; 100.0 1.0e-7 0.001 0.5866033201333333 8.43091464378425e-6 7428.8; 100.0 1.0e-7 0.0001 0.6310643531333333 8.4907033286237e-6 7434.4; 100.0 1.0e-7 1.0e-5 0.7509786598666667 8.595734863396898e-6 7470.4; 100.0 1.0e-7 1.0e-6 0.9051435333333334 8.269181447384663e-6 7440.4; 100.0 1.0e-7 1.0e-7 1.5059073796666667 8.340636103424383e-6 7442.0; 100.0 1.0e-7 1.0e-8 2.2803674999999997 8.535041618606612e-6 7446.4; 100.0 1.0e-7 1.0e-9 3.4215902932666666 8.534318815758104e-6 7429.6; 100.0 1.0e-7 1.0e-10 5.046353733466668 8.498713757367777e-6 7441.6; 100.0 1.0e-7 1.0e-11 6.544480493266667 8.509338592239984e-6 7428.0; 100.0 1.0e-7 1.0e-12 8.695722593133333 8.501095665824679e-6 7483.6]

Plots.plot(A_RK4_DE_S6T[:,4],A_RK4_DE_S6T[:,5],xscale=:log10, yscale=:log10,label="ad",markershapes= [:circle])
Plots.plot!(A_RK4_S6T[:,4],A_RK4_S6T[:,5],xscale=:log10, yscale=:log10,label="ad+Gauss",markershapes= [:circle])
