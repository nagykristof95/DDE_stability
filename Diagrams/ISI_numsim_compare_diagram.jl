using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

A_RK4_l=[12.0 12.0 100.0 0.25426764 0.0004950315612134165 4752.0; 12.0 12.0 200.0 0.6261286202 0.00012182170712626871 9552.0; 12.0 12.0 300.0 0.78129058 5.391018315035143e-5 14352.0; 12.0 12.0 400.0 1.0448936202 3.02639933065424e-5 19152.0; 12.0 12.0 500.0 1.3144539202 1.9346695951644757e-5 23952.0; 12.0 12.0 600.0 1.55698114 1.3425170940183826e-5 28752.0; 12.0 12.0 700.0 1.8837870402 9.858220390792069e-6 33552.0; 12.0 12.0 800.0 2.0848839004000004 7.544770359440503e-6 38352.0; 12.0 12.0 900.0 2.3894242597999997 5.959517888866816e-6 43152.0; 12.0 12.0 1000.0 2.6421420202 4.826063872614898e-6 47952.0; 12.0 12.0 1100.0 2.9288789401999997 3.987712885158727e-6 52752.0; 12.0 12.0 1200.0 3.19894368 3.350250451105153e-6 57552.0; 12.0 12.0 1300.0 3.4458101599999997 2.854266493683271e-6 62352.0; 12.0 12.0 1400.0 3.8985891802000006 2.4607934211385843e-6 67152.0; 12.0 12.0 1500.0 4.0553455596 2.14341130455456e-6 71952.0]

A_RK4_c=[12.0 12.0 100.0 0.3016197002 8.900512728283578e-6 4752.0; 12.0 12.0 200.0 0.7058483398 7.073404520192658e-7 9552.0; 12.0 12.0 300.0 1.0906607206 1.7409079682009653e-7 14352.0; 12.0 12.0 400.0 1.3367096198000001 6.657233402329839e-8 19152.0; 12.0 12.0 500.0 1.6282023998 3.210682605402098e-8 23952.0; 12.0 12.0 600.0 1.9781420196 1.7854953645109787e-8 28752.0; 12.0 12.0 700.0 2.2006683396 1.0930623446924971e-8 33552.0; 12.0 12.0 800.0 2.4306067997999996 7.17034965147974e-9 38352.0; 12.0 12.0 900.0 2.7333388402 4.954990739168412e-9 43152.0; 12.0 12.0 1000.0 3.3793512198 3.566017269275446e-9 47952.0; 12.0 12.0 1100.0 3.45478872 2.6513465991411844e-9 52752.0; 12.0 12.0 1200.0 3.9326522800000006 2.0246111106831307e-9 57552.0; 12.0 12.0 1300.0 4.470090959999999 1.5808478142206741e-9 62352.0; 12.0 12.0 1400.0 4.21032424 1.2578632330966558e-9 67152.0; 12.0 12.0 1500.0 5.0341264598 1.0172004815085196e-9 71952.0]

A_AB4=[12.0 12.0 100.0 0.25122549959999996 0.0002962384103982364 1152.0; 12.0 12.0 200.0 0.34225486020000007 1.900151117447219e-5 2352.0; 12.0 12.0 300.0 0.5193777199999999 3.791718105164717e-6 3552.0; 12.0 12.0 400.0 0.6821282002 1.2077048846049836e-6 4752.0; 12.0 12.0 500.0 0.7623137200000001 4.972964722181728e-7 5952.0; 12.0 12.0 600.0 0.8816791397999999 2.4093542419502426e-7 7152.0; 12.0 12.0 700.0 1.02293888 1.3060644478399228e-7 8352.0; 12.0 12.0 800.0 1.1209845398 7.68687998217248e-8 9552.0; 12.0 12.0 900.0 1.2538106199999999 4.8175806577272315e-8 10752.0; 12.0 12.0 1000.0 1.3755934196 3.1728064380448956e-8 11952.0; 12.0 12.0 1100.0 1.5049998800000002 2.17513082982388e-8 13152.0; 12.0 12.0 1200.0 1.5956482798 1.5414158608188505e-8 14352.0; 12.0 12.0 1300.0 1.7380500396000003 1.1231605948139552e-8 15552.0; 12.0 12.0 1400.0 1.88151554 8.380294187347555e-9 16752.0; 12.0 12.0 1500.0 1.9992797208 6.3819129316817644e-9 17952.0]

A_RK4_dense=[12.0 12.0 100.0 0.35481 6.611908718027378e-6 4764.0; 12.0 12.0 200.0 0.7330705402 4.0412555753303157e-7 9564.0; 12.0 12.0 300.0 0.9766026004 7.923462594193724e-8 14364.0; 12.0 12.0 400.0 1.2263407599999998 2.497689448766566e-8 19212.0; 12.0 12.0 500.0 1.5914457804 1.020761913934924e-8 23964.0; 12.0 12.0 600.0 1.9870412196 4.915175077363507e-9 28812.0; 12.0 12.0 700.0 2.20506582 2.6501657874738444e-9 33612.0; 12.0 12.0 800.0 2.4101730402 1.552075243039198e-9 38412.0; 12.0 12.0 900.0 2.75626602 9.683703911614496e-10 43164.0; 12.0 12.0 1000.0 3.1417605604000003 6.350779158852792e-10 47964.0; 12.0 12.0 1100.0 3.5543027594 4.3361824661761387e-10 52764.0; 12.0 12.0 1200.0 4.6954424994 3.0591825319462366e-10 57564.0; 12.0 12.0 1300.0 4.7472751004000004 2.2204542124384988e-10 62364.0; 12.0 12.0 1400.0 6.049554639599999 1.650127296048016e-10 67164.0; 12.0 12.0 1500.0 5.3434859998 1.2520355884859122e-10 71964.0]

A_RK4_dense_ad=hcat([12.0 12.0 3.1622776601683795e-5 0.27087605940000004 0.0001864029377155428 3672.0; 12.0 12.0 1.0000000000000003e-5 0.3253178 6.757867987024557e-5 4658.4; 12.0 12.0 3.162277660168379e-6 0.3783299804 2.4324721352816197e-5 5904.0; 12.0 12.0 1.0000000000000004e-6 0.48406484 8.582824762454913e-6 7609.2; 12.0 12.0 3.162277660168379e-7 0.7443060398 3.1221059193275363e-6 9762.0; 12.0 12.0 1.0000000000000004e-7 0.8956536197999998 1.1113996060055408e-6 12615.6; 12.0 12.0 3.162277660168379e-8 0.9883554406 3.9370218378984193e-7 16184.4; 12.0 12.0 1.0000000000000004e-8 1.2170555801999998 1.4071519704865767e-7 20995.2; 12.0 12.0 3.1622776601683795e-9 1.5341132794 5.027656478556598e-8 27154.8; 12.0 12.0 1.0000000000000009e-9 2.0092091398000003 1.821761740223729e-8 35077.2; 12.0 12.0 3.1622776601683795e-10 2.6264812003999998 6.4700951550705674e-9 45546.0; 12.0 12.0 1.0000000000000006e-10 3.4048527191999995 2.318854265403639e-9 58952.4; 12.0 12.0 3.1622776601683794e-11 3.9687617198 8.305634687381468e-10 76813.2; 12.0 12.0 1.0000000000000006e-11 5.801085179799999 2.983862361992245e-10 99517.2; 12.0 12.0 3.1622776601683794e-12 7.049155560200001 1.0557437228771502e-10 129972.0],transpose([48.8 60.8 77.8 97.5 127.5 160.5 208.3 265.7 339.1 441.5 566.3 725.1 933.3 1210.2 1547.1]))




Plots.plot(hcat(A_RK4_l[:,3],A_RK4_c[:,3],A_AB4[:,3],A_RK4_dense[:,3],A_RK4_dense_ad[:,7]),hcat(A_RK4_l[:,5],A_RK4_c[:,5],A_AB4[:,5],A_RK4_dense[:,5],A_RK4_dense_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["RK4 lin" "RK4 cub" "AB4" "RK4 dense" "RK4 dense ad"],markershapes= [:circle],xlabel = "segment number",ylabel = "eigenvalue error")

Plots.plot(hcat(A_RK4_l[:,6],A_RK4_c[:,6],A_AB4[:,6],A_RK4_dense[:,6],A_RK4_dense_ad[:,6]),hcat(A_RK4_l[:,5],A_RK4_c[:,5],A_AB4[:,5],A_RK4_dense[:,5],A_RK4_dense_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["RK4 lin" "RK4 cub" "AB4" "RK4 dense" "RK4 dense ad"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.plot(hcat(A_RK4_l[:,4],A_RK4_c[:,4],A_AB4[:,4],A_RK4_dense[:,4],A_RK4_dense_ad[:,4]),hcat(A_RK4_l[:,5],A_RK4_c[:,5],A_AB4[:,5],A_RK4_dense[:,5],A_RK4_dense_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["RK4 lin" "RK4 cub" "AB4" "RK4 dense" "RK4 dense ad"],markershapes= [:circle],xlabel = "CPU time",ylabel = "eigenvalue error")

println(A_RK4_dense_ad)

Plots.savefig("1.pdf")
