using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

valref=-0.6450472841316353 + 0.8845000929140702*im

A_RK4_dense_fix=[12.0 12.0 100.0 0.36800659999999996 6.611910076068724e-6 4764.0; 12.0 12.0 200.0 0.8063197495000001 4.041268942579142e-7 9564.0; 12.0 12.0 300.0 1.1236262505 7.923595510598642e-8 14364.0; 12.0 12.0 400.0 1.4735704 2.497821972469522e-8 19212.0; 12.0 12.0 500.0 1.9107972 1.0208942026646763e-8 23964.0; 12.0 12.0 600.0 2.0530668495 4.916496539407622e-9 28812.0; 12.0 12.0 700.0 2.7408857495000003 2.651485597123778e-9 33612.0; 12.0 12.0 800.0 2.7594159995 1.5533952859318213e-9 38412.0; 12.0 12.0 900.0 3.4622367 9.69689401213736e-10 43164.0; 12.0 12.0 1000.0 3.4547259505000003 6.3639674646215e-10 47964.0; 12.0 12.0 1100.0 4.4484439995 4.349359747059891e-10 52764.0; 12.0 12.0 1200.0 5.1531697004999995 3.0723462159850486e-10 57564.0; 12.0 12.0 1300.0 5.41106205 2.2336280736618747e-10 62364.0; 12.0 12.0 1400.0 5.40631065 1.6632929486847107e-10 67164.0; 12.0 12.0 1500.0 6.2274507505 1.2652050609984547e-10 71964.0]

A_RK4_G_fix=[100.0 1.0e-5 1.0e-5 0.636828494999995 6.6232623989090145e-6 4764.0; 200.0 1.0e-5 1.0e-5 1.0577179995 3.9775305994926236e-7 9564.0; 300.0 1.0e-5 1.0e-5 1.2207288995 7.924267417870053e-8 14364.0; 400.0 1.0e-5 1.0e-5 1.6057361 2.7453310361664868e-8 19212.0; 500.0 1.0e-5 1.0e-5 1.8865186999999999 8.712636037900155e-9 23964.0; 600.0 1.0e-5 1.0e-5 2.1971412005 4.798231003245752e-9 28812.0; 700.0 1.0e-5 1.0e-5 2.345612399 2.0047038053967516e-9 33612.0; 800.0 1.0e-5 1.0e-5 2.6367326495 1.6247818325738975e-9 38412.0; 900.0 1.0e-5 1.0e-5 2.7548266495 1.168918113608244e-9 43164.0; 1000.0 1.0e-5 1.0e-5 3.27731275 4.747197627341379e-10 47964.0; 1100.0 1.0e-5 1.0e-5 3.3929618 4.5527892516307227e-10 52764.0; 1200.0 1.0e-5 1.0e-5 3.7524524495 2.491203931100646e-10 57564.0; 1300.0 1.0e-5 1.0e-5 3.9785277505 3.109322723939894e-10 62364.0; 1400.0 1.0e-5 1.0e-5 4.62020385 1.6440389514799675e-10 67164.0; 1500.0 1.0e-5 1.0e-5 4.3826285495 1.3890110753074398e-10 71964.0]

A_RK4_G_ad=[49.0 1.0e-5 3.1622776601683795e-5 0.581311548999999 0.00017391247700302686 3510.0; 62.0 1.0e-5 1.0000000000000003e-5 0.68445635 6.527274980850266e-5 4398.0; 80.0 1.0e-5 3.162277660168379e-6 0.8731486500000001 2.469276788214411e-5 6000.0; 100.0 1.0e-5 1.0000000000000004e-6 0.9333704995000001 8.64622831507958e-6 7443.0; 126.0 1.0e-5 3.162277660168379e-7 0.9806157005 2.8369713075419667e-6 9375.0; 164.0 1.0e-5 1.0000000000000004e-7 1.1249067 1.1801323818373306e-6 11943.0; 211.0 1.0e-5 3.162277660168379e-8 1.3251388990000001 4.025322959565964e-7 15552.0; 270.0 1.0e-5 1.0000000000000004e-8 1.6474214995 1.2793946732015666e-7 20088.0; 348.0 1.0e-5 3.1622776601683795e-9 2.5669296005 4.472120881896504e-8 25476.0; 447.0 1.0e-5 1.0000000000000009e-9 2.78054275 1.6794713856404113e-8 32655.0; 575.0 1.0e-5 3.1622776601683795e-10 3.34314635 6.640553109008255e-9 42354.0; 736.0 1.0e-5 1.0000000000000006e-10 3.6891553495 2.345825113339395e-9 53862.0; 958.0 1.0e-5 3.1622776601683794e-11 4.40258545 7.969132302848301e-10 70050.0; 1237.0 1.0e-5 1.0000000000000006e-11 5.0242583995 2.8687114896693756e-10 88431.0; 1581.0 1.0e-5 3.1622776601683794e-12 6.220203100499999 1.1380901240585819e-10 115023.0]

A_RK4_com_fix=[100.0 1.0e-5 1.0e-5 1.110075299 7.230047047116025e-6 4860.0; 200.0 1.0e-5 1.0e-5 1.7184017505 4.445415821206068e-7 9660.0; 300.0 1.0e-5 1.0e-5 2.527014199 8.836038868336819e-8 14460.0; 400.0 1.0e-5 1.0e-5 3.4951235005 2.7841472350862788e-8 19260.0; 500.0 1.0e-5 1.0e-5 4.36882385 1.1615154615724376e-8 24012.0; 600.0 1.0e-5 1.0e-5 5.2672086 5.5115070706995745e-9 28812.0; 700.0 1.0e-5 1.0e-5 6.9786191505 3.005533767394195e-9 33660.0; 800.0 1.0e-5 1.0e-5 8.0885885 1.7552464765353827e-9 38412.0; 900.0 1.0e-5 1.0e-5 7.870477750000001 1.1053361838323881e-9 43260.0; 1000.0 1.0e-5 1.0e-5 10.16819495 7.220694529622158e-10 48060.0; 1100.0 1.0e-5 1.0e-5 10.9082424005 5.084178806528294e-10 52812.0; 1200.0 1.0e-5 1.0e-5 10.8239143495 3.4715935157794113e-10 57660.0; 1300.0 1.0e-5 1.0e-5 11.715080449999999 2.5655771631902313e-10 62460.0; 1400.0 1.0e-5 1.0e-5 12.1480155495 1.8723790581142827e-10 67212.0; 1500.0 1.0e-5 1.0e-5 13.07338255 1.430529831398408e-10 72060.0]

A_RK4_com_ad=[64.0 1.0e-5 3.1622776601683795e-5 1.0343069005 0.0003254335495277435 5430.0; 80.0 1.0e-5 1.0000000000000003e-5 1.4379967 0.00011917901376074118 6690.0; 103.0 1.0e-5 3.162277660168379e-6 1.9071570995 4.4488456364406305e-5 8820.0; 129.0 1.0e-5 1.0000000000000004e-6 2.2591349495 1.6097276646343558e-5 11106.0; 166.0 1.0e-5 3.162277660168379e-7 2.9491270005 6.020904755117929e-6 14475.0; 208.0 1.0e-5 1.0000000000000004e-7 3.601079951 2.1688171853647276e-6 18525.0; 263.0 1.0e-5 3.162277660168379e-8 4.7503785005 7.926550927086615e-7 23595.0; 332.0 1.0e-5 1.0000000000000004e-8 5.7408293005 2.8879723441587175e-7 29976.0; 421.0 1.0e-5 3.1622776601683795e-9 7.6700678505 1.05261771546471e-7 38001.0; 542.0 1.0e-5 1.0000000000000009e-9 9.7650454005 3.756318860721472e-8 49050.0; 694.0 1.0e-5 3.1622776601683795e-10 13.36401025 1.3997428841605278e-8 62808.0; 870.0 1.0e-5 1.0000000000000006e-10 15.1372894005 5.036401860783854e-9 78354.0; 1115.0 1.0e-5 3.1622776601683794e-11 19.781349601000002 1.8776425522137944e-9 100620.0; 1421.0 1.0e-5 1.0000000000000006e-11 25.154713250500002 6.818353475278585e-10 128367.0; 1810.0 1.0e-5 3.1622776601683794e-12 33.0468696005 2.5019016726619684e-10 163476.0]
println(A_RK4)


Plots.plot(hcat(A_RK4_dense_fix[:,3],A_RK4_G_fix[:,1],A_RK4_G_ad[:,1],A_RK4_com_fix[:,1],A_RK4_com_ad[:,1]),hcat(A_RK4_dense_fix[:,5],A_RK4_G_fix[:,5],A_RK4_G_ad[:,5],A_RK4_com_fix[:,5],A_RK4_com_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["fix" "int fix" "int ad" "com fix" "com ad"],markershapes= [:circle],xlabel = "segment number",ylabel = "eigenvalue error")

Plots.plot(hcat(A_RK4_dense_fix[:,6],A_RK4_G_fix[:,6],A_RK4_G_ad[:,6],A_RK4_com_fix[:,6],A_RK4_com_ad[:,6]),hcat(A_RK4_dense_fix[:,5],A_RK4_G_fix[:,5],A_RK4_G_ad[:,5],A_RK4_com_fix[:,5],A_RK4_com_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["fix" "int fix" "int ad" "com fix" "com ad"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.plot(hcat(A_RK4_dense_fix[:,4],A_RK4_G_fix[:,4],A_RK4_G_ad[:,4],A_RK4_com_fix[:,4],A_RK4_com_ad[:,4]),hcat(A_RK4_dense_fix[:,5],A_RK4_G_fix[:,5],A_RK4_G_ad[:,5],A_RK4_com_fix[:,5],A_RK4_com_ad[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",markershapes= [:circle],label=["fix" "int fix" "int ad" "com fix" "com ad"],xlabel = "CPU time",ylabel = "eigenvalue error")

println(A_RK4_dense_ad)

Plots.savefig("1.pdf")
