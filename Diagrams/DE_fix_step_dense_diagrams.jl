using Printf
using Statistics
using LinearAlgebra
using Interpolations
using DelimitedFiles
using Plots

#quadratic
A_EE_J_dense=[12.0 12.0 100.0 6.082525599 0.4219867343792051 1200.0; 12.0 12.0 200.0 1.8202167 0.18846417193554665 2400.0; 12.0 12.0 300.0 2.6996539 0.12114751285231291 3600.0; 12.0 12.0 400.0 3.8315177 0.08924110641570303 4800.0; 12.0 12.0 500.0 4.5022261 0.07063189795510359 6000.0; 12.0 12.0 600.0 5.4328455 0.05844272796690567 7200.0; 12.0 12.0 700.0 6.310739801 0.04984066207470615 8400.0; 12.0 12.0 800.0 7.228957799 0.04344557808369001 9600.0; 12.0 12.0 900.0 8.227431699 0.03850479182497844 10800.0; 12.0 12.0 1000.0 9.661621799 0.034572917285590234 12000.0; 12.0 12.0 1100.0 9.732405999 0.03136957708893886 13200.0; 12.0 12.0 1200.0 10.7484037 0.028709468766703414 14400.0; 12.0 12.0 1300.0 11.5734341 0.02646521692879302 15600.0; 12.0 12.0 1400.0 12.1405628 0.024546379542992915 16800.0; 12.0 12.0 1500.0 13.2292378 0.022886966935453716 18000.0]

A_BS3_J_dense=[12.0 12.0 100.0 2.829993301 0.00030995745185703933 3576.0; 12.0 12.0 200.0 3.9668895 3.81050040657093e-5 7176.0; 12.0 12.0 300.0 5.864396 1.1227298332690924e-5 10776.0; 12.0 12.0 400.0 8.650802101 4.723234812585488e-6 14376.0; 12.0 12.0 500.0 10.432154499 2.414220742816311e-6 17976.0; 12.0 12.0 600.0 11.298610001 1.3955473871799302e-6 21576.0; 12.0 12.0 700.0 12.855676401 8.781223755861865e-7 25176.0; 12.0 12.0 800.0 18.0495176 5.879186639753754e-7 28776.0; 12.0 12.0 900.0 17.0235585 4.127203583277366e-7 32376.0; 12.0 12.0 1000.0 18.968988701 3.0076019587981907e-7 35976.0; 12.0 12.0 1100.0 22.7128271 2.258961786396035e-7 39576.0; 12.0 12.0 1200.0 22.700064699 1.7395302526486872e-7 43176.0; 12.0 12.0 1300.0 24.7161485 1.3678911280575312e-7 46776.0; 12.0 12.0 1400.0 28.6767276 1.0950067325217338e-7 50376.0; 12.0 12.0 1500.0 37.020611101 8.901377392069275e-8 53976.0]

A_RK4_J_dense=[12.0 12.0 100.0 2.744781701 6.611908970855256e-6 4764.0; 12.0 12.0 200.0 4.9621726 4.041257733061582e-7 9564.0; 12.0 12.0 300.0 7.5942762 7.923484545188236e-8 14364.0; 12.0 12.0 400.0 10.079521801 2.4977153243407883e-8 19164.0; 12.0 12.0 500.0 12.5223905 1.0207795774026136e-8 23964.0; 12.0 12.0 600.0 13.930565499 4.915417552104891e-9 28764.0; 12.0 12.0 700.0 17.4099572 2.650406740946333e-9 33564.0; 12.0 12.0 800.0 19.7260778 1.5523887536114359e-9 38364.0; 12.0 12.0 900.0 20.558481101 9.685575955731753e-10 43164.0; 12.0 12.0 1000.0 26.4605008 6.351644217773944e-10 47964.0; 12.0 12.0 1100.0 27.908930499 4.3366100169190735e-10 52764.0; 12.0 12.0 1200.0 33.5845758 3.060902505681023e-10 57564.0; 12.0 12.0 1300.0 35.167232901 2.2217173057388751e-10 62364.0; 12.0 12.0 1400.0 37.6253045 1.6514151723003844e-10 67164.0; 12.0 12.0 1500.0 40.7875199 1.2529326138852376e-10 71964.0]

A_T5_J_dense=[12.0 12.0 100.0 10.2087419 4.483384020021161e-9 7140.0; 12.0 12.0 200.0 7.8060641 1.2255052968870571e-10 14340.0; 12.0 12.0 300.0 12.247570599 1.5590579236087376e-11 21540.0; 12.0 12.0 400.0 17.2111395 3.6187614579177997e-12 28740.0; 12.0 12.0 500.0 24.3349464 1.1492665177157575e-12 35940.0; 12.0 12.0 600.0 28.6410337 4.36055042867719e-13 43140.0; 12.0 12.0 700.0 28.2758561 1.7839905673122937e-13 50340.0; 12.0 12.0 800.0 33.880499 7.17545137193674e-14 57540.0; 12.0 12.0 900.0 40.7356902 2.4314898120457263e-14 64740.0; 12.0 12.0 1000.0 43.6147237 1.7712494098706855e-14 71940.0; 12.0 12.0 1100.0 51.0774373 2.5051217575331603e-14 79140.0; 12.0 12.0 1200.0 55.9144535 3.2838024903793936e-14 86340.0; 12.0 12.0 1300.0 63.611313401 3.936472612426756e-14 93540.0; 12.0 12.0 1400.0 63.9309262 4.037458488863206e-14 100740.0; 12.0 12.0 1500.0 70.379168601 4.2010757099926164e-14 107940.0]

A_T5_J_dense_BF128=[12.0 12.0 100.0 23.407429299 4.483429273477147e-9 7140.0; 12.0 12.0 200.0 20.905215201 1.225964572277674e-10 14340.0; 12.0 12.0 300.0 31.893307199 1.5635965637776506e-11 21540.0; 12.0 12.0 400.0 43.345496299 3.6627874250944134e-12 28740.0; 12.0 12.0 500.0 49.458192301 1.1923534942528291e-12 35940.0; 12.0 12.0 600.0 61.1862236 4.774297508163241e-13 43140.0; 12.0 12.0 700.0 71.5256821 2.204682190873354e-13 50340.0; 12.0 12.0 800.0 81.742710599 1.1303002838583875e-13 57540.0; 12.0 12.0 900.0 89.366419801 6.281187558977009e-14 64740.0; 12.0 12.0 1000.0 106.997136801 3.725927224524519e-14 71940.0; 12.0 12.0 1100.0 115.431788501 2.338077161189286e-14 79140.0; 12.0 12.0 1200.0 128.921441599 1.5467229697543244e-14 86340.0; 12.0 12.0 1300.0 138.9765396 1.0805689982225063e-14 93540.0; 12.0 12.0 1400.0 156.4471 8.016221895760509e-15 100740.0; 12.0 12.0 1500.0 155.456026399 6.3474007759199085e-15 107940.0]
println(A_T5)

Plots.plot(A_T5_J_dense[:,3],hcat(A_T5_J_dense[:,5],A_RK4_J_dense[:,5],A_BS3_J_dense[:,5],A_EE_J_dense[:,5],A_T5_J_dense_BF128[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["T5 dense" "RK4 dense" "BS3 dense" "EE dense" "T5 dense BF128"],markershapes= [:circle],xlabel = "number of steps",ylabel = "eigenvalue error")

Plots.plot(hcat(A_T5_J_dense[:,6],A_RK4_J_dense[:,6],A_BS3_J_dense[:,6],A_EE_J_dense[:,6],A_T5_J_dense_BF128[:,6]),hcat(A_T5_J_dense[:,5],A_RK4_J_dense[:,5],A_BS3_J_dense[:,5],A_EE_J_dense[:,5],A_T5_J_dense_BF128[:,5]),xscale=:log10, yscale=:log10,title="Comparaison of methods A",label=["T5 dense" "RK4 dense" "BS3 dense" "EE dense" "T5 dense BF128"],markershapes= [:circle],xlabel = "function calls",ylabel = "eigenvalue error")

Plots.plot(A_T5_J_dense[:,3],hcat(A_T5_J_dense[:,5],A_T5_J_dense_BF128[:,5]),xscale=:log10, yscale=:log10,title="Largest eigenvalue error A",label=["T5 dense" "T5 dense BF128"],markershapes= [:circle],xlabel = "number of steps",ylabel = "eigenvalue error")


open("temp.txt", "w") do io
           writedlm(io, A_T5_J_dense_BF128)
       end

Plots.savefig("1.pdf")
